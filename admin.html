<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo Admin - Mercenary PvM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'merc-bg': '#0d0f14',
                        'merc-card': '#151821',
                        'merc-border': '#2a3042',
                        'merc-accent': '#e6a919',
                        'merc-orange': '#ff6b35',
                        'merc-blue': '#3b82f6',
                        'merc-green': '#22c55e',
                        'merc-purple': '#a855f7',
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Rajdhani', sans-serif; background: #0d0f14; color: white; }
        .font-display { font-family: 'Cinzel', serif; }
        input, select, textarea { background: #0d0f14 !important; color: white !important; border: 1px solid #2a3042; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: #e6a919; }
        select option { background: #0d0f14; color: white; }
        .spinner { width: 40px; height: 40px; border: 3px solid #2a3042; border-top-color: #e6a919; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .tile-preview { 
            width: 80px; height: 80px; 
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 2px solid #2a3042;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            font-size: 0.6rem; text-align: center;
            cursor: pointer; transition: all 0.2s;
            position: relative;
        }
        .tile-preview:hover { border-color: #e6a919; transform: scale(1.05); }
        .tile-preview.selected { border-color: #e6a919; box-shadow: 0 0 10px rgba(230, 169, 25, 0.3); }
        .team-color { width: 24px; height: 24px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; }
        .team-color:hover, .team-color.selected { border-color: white; }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        const API_BASE = 'https://api.mercenarypvm.co.uk/api';
        
        // Boss drops for random generation
        const BOSS_DROPS = [
            { item: 'Bandos Chestplate', boss: 'General Graardor' },
            { item: 'Bandos Tassets', boss: 'General Graardor' },
            { item: 'Armadyl Chestplate', boss: "Kree'arra" },
            { item: 'Armadyl Chainskirt', boss: "Kree'arra" },
            { item: 'Twisted Bow', boss: 'Chambers of Xeric' },
            { item: 'Scythe of Vitur', boss: 'Theatre of Blood' },
            { item: 'Torva Platebody', boss: 'Nex' },
            { item: 'Dragon Claws', boss: 'Chambers of Xeric' },
            { item: 'Tumeken\'s Shadow', boss: 'Tombs of Amascut' },
            { item: 'Masori Body', boss: 'Tombs of Amascut' },
            { item: 'Zaryte Crossbow', boss: 'Nex' },
            { item: 'Inquisitor\'s Hauberk', boss: 'Nightmare' },
            { item: 'Nightmare Staff', boss: 'Nightmare' },
            { item: 'Sanguinesti Staff', boss: 'Theatre of Blood' },
            { item: 'Ghrazi Rapier', boss: 'Theatre of Blood' },
            { item: 'Avernic Defender', boss: 'Theatre of Blood' },
            { item: 'Ancestral Robe Top', boss: 'Chambers of Xeric' },
            { item: 'Elder Maul', boss: 'Chambers of Xeric' },
            { item: 'Kodai Insignia', boss: 'Chambers of Xeric' },
            { item: 'Dexterous Prayer Scroll', boss: 'Chambers of Xeric' },
            { item: 'Arcane Prayer Scroll', boss: 'Chambers of Xeric' },
            { item: 'Hydra Claw', boss: 'Alchemical Hydra' },
            { item: 'Primordial Crystal', boss: 'Cerberus' },
            { item: 'Pegasian Crystal', boss: 'Cerberus' },
            { item: 'Eternal Crystal', boss: 'Cerberus' },
        ];

        const TEAM_COLORS = ['#e6a919', '#3b82f6', '#22c55e', '#ef4444', '#a855f7', '#ec4899', '#14b8a6', '#f97316'];

        function App() {
            const [authenticated, setAuthenticated] = useState(false);
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);
            const [rooms, setRooms] = useState([]);
            const [activeTab, setActiveTab] = useState('create');
            
            // Create room state
            const [roomId, setRoomId] = useState('');
            const [roomPassword, setRoomPassword] = useState('');
            const [rows, setRows] = useState(3);
            const [cols, setCols] = useState(3);
            const [winCondition, setWinCondition] = useState('line');
            const [isEvent, setIsEvent] = useState(false);
            const [requireVerification, setRequireVerification] = useState(true);
            
            // Custom board state
            const [useCustomBoard, setUseCustomBoard] = useState(false);
            const [customTiles, setCustomTiles] = useState([]);
            const [selectedTile, setSelectedTile] = useState(null);
            const [tileItem, setTileItem] = useState('');
            const [tileBoss, setTileBoss] = useState('');
            const [tileImage, setTileImage] = useState('');
            const [tilePoints, setTilePoints] = useState(1);
            const [revealAllAtStart, setRevealAllAtStart] = useState(false);
            
            // Background state
            const [cardBackground, setCardBackground] = useState('');
            const [starImage, setStarImage] = useState('');
            
            // Team state
            const [teamMode, setTeamMode] = useState(false);
            const [teams, setTeams] = useState([
                { name: 'Team 1', color: '#e6a919' },
                { name: 'Team 2', color: '#3b82f6' }
            ]);

            // Initialize custom tiles when dimensions change
            useEffect(() => {
                const numTiles = rows * cols;
                const newTiles = [];
                for (let i = 0; i < numTiles; i++) {
                    if (customTiles[i]) {
                        newTiles.push(customTiles[i]);
                    } else {
                        const randomDrop = BOSS_DROPS[Math.floor(Math.random() * BOSS_DROPS.length)];
                        newTiles.push({ item: randomDrop.item, boss: randomDrop.boss, customImage: '' });
                    }
                }
                setCustomTiles(newTiles);
                setSelectedTile(null);
            }, [rows, cols]);

            const handleLogin = async () => {
                setLoading(true);
                setError('');
                try {
                    const res = await fetch(`${API_BASE}/auth/verify`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ password })
                    });
                    const data = await res.json();
                    if (data.success) {
                        setAuthenticated(true);
                        sessionStorage.setItem('bingoAdminPwd', password);
                        loadRooms();
                    } else {
                        setError('Invalid password');
                    }
                } catch (err) {
                    setError('Connection error');
                }
                setLoading(false);
            };

            const loadRooms = async () => {
                try {
                    const res = await fetch(`${API_BASE}/admin/rooms`);
                    const data = await res.json();
                    setRooms(data.rooms || []);
                } catch (err) {
                    console.error('Failed to load rooms:', err);
                }
            };

            useEffect(() => {
                const saved = sessionStorage.getItem('bingoAdminPwd');
                if (saved) {
                    setPassword(saved);
                    setAuthenticated(true);
                    loadRooms();
                }
            }, []);

            const handleCreateRoom = async () => {
                if (!roomId.trim()) {
                    alert('Please enter a room ID');
                    return;
                }

                setLoading(true);
                try {
                    const payload = {
                        roomId: roomId.trim(),
                        password: roomPassword || null,
                        rows,
                        cols,
                        winCondition,
                        requireVerification,
                        isEvent,
                        customTiles: useCustomBoard ? customTiles : null,
                        cardBackground: cardBackground || null,
                        starImage: starImage || null,
                        teamMode,
                        teams: teamMode ? teams : null,
                        revealAllAtStart
                    };

                    const res = await fetch(`${API_BASE}/admin/room/create`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    
                    const data = await res.json();
                    
                    if (data.success) {
                        alert(`Room "${roomId}" created successfully!`);
                        setRoomId('');
                        setRoomPassword('');
                        loadRooms();
                    } else {
                        alert('Error: ' + (data.error || 'Failed to create room'));
                    }
                } catch (err) {
                    alert('Connection error');
                }
                setLoading(false);
            };

            const handleDeleteRoom = async (id) => {
                if (!confirm(`Delete room "${id}"?`)) return;
                
                try {
                    await fetch(`${API_BASE}/admin/room/${id}`, { method: 'DELETE' });
                    loadRooms();
                } catch (err) {
                    alert('Failed to delete room');
                }
            };

            const randomizeBoard = () => {
                const shuffled = [...BOSS_DROPS].sort(() => Math.random() - 0.5);
                const numTiles = rows * cols;
                const newTiles = [];
                for (let i = 0; i < numTiles; i++) {
                    const drop = shuffled[i % shuffled.length];
                    newTiles.push({ item: drop.item, boss: drop.boss, customImage: '' });
                }
                setCustomTiles(newTiles);
            };

            const handleTileClick = (index) => {
                setSelectedTile(index);
                const tile = customTiles[index];
                setTileItem(tile?.item || '');
                setTileBoss(tile?.boss || '');
                setTileImage(tile?.customImage || '');
                setTilePoints(tile?.points || 1);
            };

            const saveTile = () => {
                if (selectedTile === null) return;
                const newTiles = [...customTiles];
                newTiles[selectedTile] = { item: tileItem, boss: tileBoss, customImage: tileImage, points: parseInt(tilePoints) || 1 };
                setCustomTiles(newTiles);
            };

            const handleBackgroundUpload = (e) => {
                const file = e.target.files[0];
                if (file && file.size < 500000) {
                    const reader = new FileReader();
                    reader.onload = (ev) => setCardBackground(ev.target.result);
                    reader.readAsDataURL(file);
                } else if (file) {
                    alert('Image too large. Max 500KB.');
                }
            };

            const handleStarImageUpload = (e) => {
                const file = e.target.files[0];
                if (file && file.size < 300000) {
                    const reader = new FileReader();
                    reader.onload = (ev) => setStarImage(ev.target.result);
                    reader.readAsDataURL(file);
                } else if (file) {
                    alert('Image too large. Max 300KB.');
                }
            };

            const handleTileImageUpload = (e) => {
                const file = e.target.files[0];
                if (file && file.size < 200000) {
                    const reader = new FileReader();
                    reader.onload = (ev) => setTileImage(ev.target.result);
                    reader.readAsDataURL(file);
                } else if (file) {
                    alert('Image too large. Max 200KB.');
                }
            };

            const addTeam = () => {
                if (teams.length >= 8) return;
                const nextColor = TEAM_COLORS[teams.length % TEAM_COLORS.length];
                setTeams([...teams, { name: `Team ${teams.length + 1}`, color: nextColor }]);
            };

            const removeTeam = (index) => {
                if (teams.length <= 2) return;
                setTeams(teams.filter((_, i) => i !== index));
            };

            const updateTeam = (index, field, value) => {
                const newTeams = [...teams];
                newTeams[index][field] = value;
                setTeams(newTeams);
            };

            if (!authenticated) {
                return (
                    <div className="flex items-center justify-center min-h-screen">
                        <div className="bg-merc-card border border-merc-border rounded-xl p-8 max-w-md w-full">
                            <h1 className="font-display text-2xl font-bold text-center mb-6">üîí Bingo Admin</h1>
                            <input
                                type="password"
                                value={password}
                                onChange={(e) => setPassword(e.target.value)}
                                onKeyPress={(e) => e.key === 'Enter' && handleLogin()}
                                placeholder="Enter staff password"
                                className="w-full rounded-lg px-4 py-3 mb-4"
                            />
                            {error && <p className="text-red-400 text-sm mb-4">{error}</p>}
                            <button
                                onClick={handleLogin}
                                disabled={loading}
                                className="w-full py-3 bg-merc-accent text-merc-bg font-bold rounded-lg hover:opacity-90 disabled:opacity-50"
                            >
                                {loading ? 'Verifying...' : 'Login'}
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="max-w-6xl mx-auto">
                    <div className="flex items-center justify-between mb-8">
                        <h1 className="font-display text-3xl font-bold">üé≤ Bingo Admin</h1>
                        <a href="index.html" className="text-merc-accent hover:underline">‚Üê Back to Site</a>
                    </div>

                    {/* Tabs */}
                    <div className="flex gap-2 mb-6">
                        <button
                            onClick={() => setActiveTab('create')}
                            className={`px-4 py-2 rounded-lg font-semibold ${activeTab === 'create' ? 'bg-merc-accent text-merc-bg' : 'bg-merc-card'}`}
                        >
                            ‚ûï Create Game
                        </button>
                        <button
                            onClick={() => { setActiveTab('manage'); loadRooms(); }}
                            className={`px-4 py-2 rounded-lg font-semibold ${activeTab === 'manage' ? 'bg-merc-accent text-merc-bg' : 'bg-merc-card'}`}
                        >
                            üìã Manage Games ({rooms.length})
                        </button>
                    </div>

                    {activeTab === 'create' && (
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            {/* Left Column - Settings */}
                            <div className="space-y-6">
                                {/* Basic Settings */}
                                <div className="bg-merc-card border border-merc-border rounded-xl p-6">
                                    <h2 className="font-display text-xl font-bold mb-4">Basic Settings</h2>
                                    
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="text-gray-400 text-sm block mb-1">Room ID *</label>
                                            <input
                                                type="text"
                                                value={roomId}
                                                onChange={(e) => setRoomId(e.target.value)}
                                                placeholder="my-bingo-game"
                                                className="w-full rounded-lg px-3 py-2"
                                            />
                                        </div>
                                        <div>
                                            <label className="text-gray-400 text-sm block mb-1">Room Password</label>
                                            <input
                                                type="text"
                                                value={roomPassword}
                                                onChange={(e) => setRoomPassword(e.target.value)}
                                                placeholder="Optional"
                                                className="w-full rounded-lg px-3 py-2"
                                            />
                                        </div>
                                    </div>

                                    <div className="grid grid-cols-3 gap-4 mt-4">
                                        <div>
                                            <label className="text-gray-400 text-sm block mb-1">Rows</label>
                                            <input
                                                type="number"
                                                min="2"
                                                max="10"
                                                value={rows}
                                                onChange={(e) => setRows(parseInt(e.target.value) || 3)}
                                                className="w-full rounded-lg px-3 py-2"
                                            />
                                        </div>
                                        <div>
                                            <label className="text-gray-400 text-sm block mb-1">Columns</label>
                                            <input
                                                type="number"
                                                min="2"
                                                max="10"
                                                value={cols}
                                                onChange={(e) => setCols(parseInt(e.target.value) || 3)}
                                                className="w-full rounded-lg px-3 py-2"
                                            />
                                        </div>
                                        <div>
                                            <label className="text-gray-400 text-sm block mb-1">Win Condition</label>
                                            <select
                                                value={winCondition}
                                                onChange={(e) => setWinCondition(e.target.value)}
                                                className="w-full rounded-lg px-3 py-2"
                                            >
                                                <option value="line">Line (Row/Col/Diag)</option>
                                                <option value="full">Full Board</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div className="flex flex-wrap gap-4 mt-4">
                                        <label className="flex items-center gap-2 cursor-pointer">
                                            <input type="checkbox" checked={isEvent} onChange={(e) => setIsEvent(e.target.checked)} className="accent-merc-accent" />
                                            <span>üèÜ Event Game</span>
                                        </label>
                                        <label className="flex items-center gap-2 cursor-pointer">
                                            <input type="checkbox" checked={requireVerification} onChange={(e) => setRequireVerification(e.target.checked)} className="accent-merc-accent" />
                                            <span>‚úÖ Require Verification</span>
                                        </label>
                                        <label className="flex items-center gap-2 cursor-pointer">
                                            <input type="checkbox" checked={revealAllAtStart} onChange={(e) => setRevealAllAtStart(e.target.checked)} className="accent-merc-accent" />
                                            <span>üëÅÔ∏è Reveal All Tiles at Start</span>
                                        </label>
                                    </div>
                                </div>

                                {/* Team Mode */}
                                <div className="bg-merc-card border border-merc-border rounded-xl p-6">
                                    <label className="flex items-center gap-2 cursor-pointer mb-4">
                                        <input type="checkbox" checked={teamMode} onChange={(e) => setTeamMode(e.target.checked)} className="accent-merc-accent" />
                                        <span className="font-display font-bold text-lg">üë• Team Mode</span>
                                    </label>

                                    {teamMode && (
                                        <div className="space-y-3">
                                            {teams.map((team, i) => (
                                                <div key={i} className="flex items-center gap-3">
                                                    <input
                                                        type="text"
                                                        value={team.name}
                                                        onChange={(e) => updateTeam(i, 'name', e.target.value)}
                                                        className="flex-1 rounded px-3 py-2"
                                                    />
                                                    <div className="flex gap-1">
                                                        {TEAM_COLORS.map(color => (
                                                            <div
                                                                key={color}
                                                                className={`team-color ${team.color === color ? 'selected' : ''}`}
                                                                style={{ backgroundColor: color }}
                                                                onClick={() => updateTeam(i, 'color', color)}
                                                            />
                                                        ))}
                                                    </div>
                                                    {teams.length > 2 && (
                                                        <button onClick={() => removeTeam(i)} className="text-red-400 hover:text-red-300">‚úï</button>
                                                    )}
                                                </div>
                                            ))}
                                            {teams.length < 8 && (
                                                <button onClick={addTeam} className="text-merc-accent hover:underline text-sm">
                                                    + Add Team
                                                </button>
                                            )}
                                        </div>
                                    )}
                                </div>

                                {/* Card Customization */}
                                <div className="bg-merc-card border border-merc-border rounded-xl p-6">
                                    <h2 className="font-display text-xl font-bold mb-4">üé® Card Appearance</h2>
                                    
                                    {/* Star/Seal Image */}
                                    <div className="mb-4">
                                        <label className="text-gray-400 text-sm block mb-2">‚≠ê Scratch Card Icon (the "?" replacement)</label>
                                        <p className="text-gray-500 text-xs mb-2">This image appears on unscratched tiles. Use a PNG with transparent background. Max 300KB.</p>
                                        <input
                                            type="file"
                                            accept="image/*"
                                            onChange={handleStarImageUpload}
                                            className="w-full"
                                        />
                                        {starImage && (
                                            <div className="mt-2 flex items-center gap-3">
                                                <div className="w-16 h-16 bg-merc-bg rounded flex items-center justify-center">
                                                    <img src={starImage} alt="Star" className="max-w-full max-h-full object-contain" />
                                                </div>
                                                <button onClick={() => setStarImage('')} className="text-red-400 text-sm">Remove</button>
                                            </div>
                                        )}
                                    </div>

                                    {/* Background Image */}
                                    <div>
                                        <label className="text-gray-400 text-sm block mb-2">üñºÔ∏è Card Background (behind the icon)</label>
                                        <p className="text-gray-500 text-xs mb-2">Optional background image for scratch cards. Max 500KB.</p>
                                        <input
                                            type="file"
                                            accept="image/*"
                                            onChange={handleBackgroundUpload}
                                            className="w-full"
                                        />
                                        {cardBackground && (
                                            <div className="mt-2 flex items-center gap-3">
                                                <img src={cardBackground} alt="Preview" className="w-16 h-16 object-cover rounded border border-merc-border" />
                                                <button onClick={() => setCardBackground('')} className="text-red-400 text-sm">Remove</button>
                                            </div>
                                        )}
                                    </div>
                                </div>

                                {/* Create Button */}
                                <button
                                    onClick={handleCreateRoom}
                                    disabled={loading || !roomId.trim()}
                                    className="w-full py-4 bg-gradient-to-r from-merc-accent to-merc-orange text-merc-bg font-display font-bold text-xl rounded-xl hover:opacity-90 disabled:opacity-50"
                                >
                                    {loading ? '‚è≥ Creating...' : 'üé≤ Create Bingo Game'}
                                </button>
                            </div>

                            {/* Right Column - Board Builder */}
                            <div className="bg-merc-card border border-merc-border rounded-xl p-6">
                                <div className="flex items-center justify-between mb-4">
                                    <label className="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" checked={useCustomBoard} onChange={(e) => setUseCustomBoard(e.target.checked)} className="accent-merc-accent" />
                                        <span className="font-display font-bold text-lg">üéØ Custom Board</span>
                                    </label>
                                    {useCustomBoard && (
                                        <button onClick={randomizeBoard} className="text-sm text-merc-accent hover:underline">
                                            üé≤ Randomize
                                        </button>
                                    )}
                                </div>

                                {useCustomBoard ? (
                                    <>
                                        {/* Board Preview */}
                                        <div 
                                            className="grid gap-1 mb-4 justify-center"
                                            style={{ gridTemplateColumns: `repeat(${cols}, 80px)` }}
                                        >
                                            {customTiles.map((tile, i) => (
                                                <div
                                                    key={i}
                                                    className={`tile-preview ${selectedTile === i ? 'selected' : ''}`}
                                                    onClick={() => handleTileClick(i)}
                                                    style={tile.customImage ? { backgroundImage: `url(${tile.customImage})`, backgroundSize: 'cover' } : {}}
                                                >
                                                    {tile.points > 1 && (
                                                        <div className="absolute top-1 right-1 bg-merc-green text-merc-bg text-xs font-bold px-1.5 py-0.5 rounded">
                                                            {tile.points}pt
                                                        </div>
                                                    )}
                                                    {!tile.customImage && (
                                                        <>
                                                            <div className="text-merc-accent font-bold truncate w-full px-1">{tile.item}</div>
                                                            <div className="text-gray-500 truncate w-full px-1">{tile.boss}</div>
                                                        </>
                                                    )}
                                                </div>
                                            ))}
                                        </div>

                                        {/* Tile Editor */}
                                        {selectedTile !== null && (
                                            <div className="border-t border-merc-border pt-4">
                                                <h3 className="font-bold mb-3">Edit Tile #{selectedTile + 1}</h3>
                                                <div className="space-y-3">
                                                    <div>
                                                        <label className="text-gray-400 text-sm block mb-1">Item Name</label>
                                                        <input
                                                            type="text"
                                                            value={tileItem}
                                                            onChange={(e) => setTileItem(e.target.value)}
                                                            className="w-full rounded px-3 py-2"
                                                            placeholder="e.g., Twisted Bow"
                                                        />
                                                    </div>
                                                    <div>
                                                        <label className="text-gray-400 text-sm block mb-1">Boss/Source</label>
                                                        <input
                                                            type="text"
                                                            value={tileBoss}
                                                            onChange={(e) => setTileBoss(e.target.value)}
                                                            className="w-full rounded px-3 py-2"
                                                            placeholder="e.g., Chambers of Xeric"
                                                        />
                                                    </div>
                                                    <div>
                                                        <label className="text-gray-400 text-sm block mb-1">Custom Image (max 200KB)</label>
                                                        <input
                                                            type="file"
                                                            accept="image/*"
                                                            onChange={handleTileImageUpload}
                                                            className="w-full"
                                                        />
                                                        {tileImage && (
                                                            <div className="mt-2 flex items-center gap-2">
                                                                <img src={tileImage} alt="Tile" className="w-12 h-12 object-cover rounded" />
                                                                <button onClick={() => setTileImage('')} className="text-red-400 text-sm">Remove</button>
                                                            </div>
                                                        )}
                                                    </div>
                                                    <div>
                                                        <label className="text-gray-400 text-sm block mb-1">Points Value</label>
                                                        <input
                                                            type="number"
                                                            min="1"
                                                            max="100"
                                                            value={tilePoints}
                                                            onChange={(e) => setTilePoints(parseInt(e.target.value) || 1)}
                                                            className="w-full rounded px-3 py-2"
                                                            placeholder="1"
                                                        />
                                                        <p className="text-xs text-gray-500 mt-1">Points awarded when tile is claimed</p>
                                                    </div>
                                                    <button
                                                        onClick={saveTile}
                                                        className="w-full py-2 bg-merc-green text-merc-bg font-bold rounded hover:opacity-90"
                                                    >
                                                        üíæ Save Tile
                                                    </button>
                                                </div>
                                            </div>
                                        )}
                                    </>
                                ) : (
                                    <div className="text-center text-gray-500 py-12">
                                        <p>Enable custom board to design your own tiles</p>
                                        <p className="text-sm mt-2">Otherwise, random boss drops will be used</p>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {activeTab === 'manage' && (
                        <div className="bg-merc-card border border-merc-border rounded-xl p-6">
                            <div className="flex items-center justify-between mb-4">
                                <h2 className="font-display text-xl font-bold">Active Games</h2>
                                <button onClick={loadRooms} className="text-merc-accent hover:underline text-sm">üîÑ Refresh</button>
                            </div>

                            {rooms.length === 0 ? (
                                <p className="text-gray-500 text-center py-8">No active games</p>
                            ) : (
                                <div className="space-y-3">
                                    {rooms.map(room => (
                                        <div key={room.roomId} className="bg-merc-bg rounded-lg p-4 flex flex-col md:flex-row md:items-center justify-between gap-4">
                                            <div className="flex-1">
                                                <div className="flex items-center gap-2 mb-1">
                                                    <h3 className="font-bold text-lg">{room.roomId}</h3>
                                                    {room.isEvent && <span className="text-xs px-2 py-0.5 bg-merc-purple/20 text-merc-purple rounded">Event</span>}
                                                    {room.teamMode && <span className="text-xs px-2 py-0.5 bg-merc-blue/20 text-merc-blue rounded">Teams</span>}
                                                    {room.hasPassword && <span className="text-xs">üîí</span>}
                                                </div>
                                                <div className="text-gray-400 text-sm">
                                                    {room.rows || room.boardSize}x{room.cols || room.boardSize} ‚Ä¢ {room.players?.length || 0} players
                                                    {room.winner && <span className="text-merc-green ml-2">üèÜ Winner: {room.winner}</span>}
                                                </div>
                                            </div>
                                            <div className="flex gap-2">
                                                <a
                                                    href={`bingo.html?room=${room.roomId}`}
                                                    target="_blank"
                                                    className="px-3 py-1 bg-merc-accent/20 text-merc-accent rounded text-sm hover:bg-merc-accent/30"
                                                >
                                                    Open
                                                </a>
                                                <button
                                                    onClick={() => handleDeleteRoom(room.roomId)}
                                                    className="px-3 py-1 bg-red-500/20 text-red-400 rounded text-sm hover:bg-red-500/30"
                                                >
                                                    Delete
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
